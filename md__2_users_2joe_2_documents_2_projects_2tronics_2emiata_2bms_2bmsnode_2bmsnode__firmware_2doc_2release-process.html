<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=9"/>
		<meta name="generator" content="Doxygen 1.11.0"/>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		<title>BMSNode: BMSNode Firmware Release Process</title>
		<link href="tabs.css" rel="stylesheet" type="text/css"/>
		<script type="text/javascript" src="jquery.js"></script>
		<script type="text/javascript" src="dynsections.js"></script>
		<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
		<link href="doxygen.css" rel="stylesheet" type="text/css" />
		<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="custom_dark_theme.css" rel="stylesheet" type="text/css"/>
	</head>
	<body>
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
		<div id="titlearea">
			<table cellspacing="0" cellpadding="0">
				<tbody>
					<tr style="height: 56px;">
						<td id="projectalign" style="padding-left: 0.5em;">
							<div id="projectname">BMSNode
							</div>
							<div id="projectbrief">BMS Node Cell Monitoring Firmware</div>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md__2_users_2joe_2_documents_2_projects_2tronics_2emiata_2bms_2bmsnode_2bmsnode__firmware_2doc_2release-process.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">BMSNode Firmware Release Process</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><code>master</code> is used for making release tags.</p>
<p>The release process uses GitLab CI to run the necessary scripts. Everything that is done by the CI processing can also be done locally first. Use the Makefile to do builds and test prior to pushing and attempting a release.</p>
<p>The release process and Makefile are run from the "build" directory. See the Makefile and <code>make help</code> to see available make targets.</p>
<p>The release process does the following high level steps:</p>
<ul>
<li>build the firmware</li>
<li>run unit test and other checks and generate reports</li>
<li>generate a version number and changelog using this tool: <a href="https://juhani.gitlab.io/go-semrel-gitlab/">https://juhani.gitlab.io/go-semrel-gitlab/</a></li>
<li>package up the artifacts into a release package, named by version, that can be downloaded from gitlab. The release package contains firmware binaries, listings and a changelog. Other notes and instructions can be added in the future.</li>
<li>once the release is approved, tag the commit used to build the release, and add links to the release package on gitlab</li>
</ul>
<h1><a class="anchor" id="autotoc_md31"></a>
Normal Release Process</h1>
<p>Given that there is a set of changes <b>on a feature branch</b> that is based on <code>master</code>:</p>
<ol type="1">
<li>rebase feature branch as needed or before attempting a release</li>
<li>annotate commit messages with fix, feat, etc per this: <a href="https://juhani.gitlab.io/go-semrel-gitlab/commit-message/">https://juhani.gitlab.io/go-semrel-gitlab/commit-message/</a></li>
<li>do whatever local testing is necessary</li>
<li>push the feature branch</li>
<li>verify release package is correctly built by GitLab CI, and looks correct</li>
<li>download release package and use the built firmware to run any necessary release functional tests</li>
<li>examine generated CHANGELOG</li>
<li>if feature branch is okay:</li>
<li>squash the feature branch onto <code>master</code></li>
<li>edit the squash commit message to reflect the set of commit type annotations (feat, fix, etc) to reflect a sensible story about the set of changes in the squash (the changes of the feature branch)</li>
<li>push the updated <code>master</code></li>
<li>verify GitLab CI build is okay</li>
<li>download generated release package and verify firmware and CHANGELOG</li>
<li>if final release package is okay:</li>
<li>Manually trigger the release stage of the GitLab CI pipeline</li>
<li>Verify tag was created and has correct releaase notes. Verify GitLab release was created.</li>
<li>after some time, delete the feature branch and any saved artifacts on GitLab. This is to keep down the number of saved artifacts to avoid confusion.</li>
</ol>
<h1><a class="anchor" id="autotoc_md32"></a>
Specific Steps</h1>
<p>Givens:</p>
<ul>
<li>operating in the "build" directory</li>
<li>on a feature branch</li>
<li>all commits made, repo is clean</li>
<li>all prior feature branches since last release tag have been merged</li>
<li>testing has been done, there is reasonable certainty that the branch is ready for release</li>
<li>branch has been pushed to GitLab and CI has run without errors</li>
</ul>
<p>Steps:</p>
<ol type="1">
<li><code>make changelog</code> to generate the CHANGELOG.md</li>
<li>review CHANGELOG and verify correct</li>
<li>CHANEGLOG will now have modified git status. Re-checkout from repo</li>
<li>squash feature branch onto master, or ff merge if branch commit history is important</li>
<li>push master</li>
<li>verify CI is good for latest master push</li>
<li>using GitLab CI UI, run the manual "release" job for the last pipeline</li>
<li>verify tag was created, and GitLab release with release notes and artifacts </li>
</ol>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
		<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
			<ul>
				<li class="footer">
					Generated on Wed Jan 22 2025 15:43:06 for BMSNode by <a href="http://www.doxygen.org/index.html">
					<img class="footer" src="doxygen.png" alt="doxygen"
                     onerror="this.onerror=null;this.src='doxygen.svg';"/></a> 1.11.0.
					Dark theme by <a href="http://majerle.eu" target="_new">Tilen Majerle</a>. All rights reserved.
				</li>
			</ul>
		</div>
		<script src="custom.js"></script>
	</body>
</html>

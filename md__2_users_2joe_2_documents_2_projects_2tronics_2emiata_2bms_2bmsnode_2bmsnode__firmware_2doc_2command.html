<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=9"/>
		<meta name="generator" content="Doxygen 1.11.0"/>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		<title>BMSNode: BMSNode Command Specification</title>
		<link href="tabs.css" rel="stylesheet" type="text/css"/>
		<script type="text/javascript" src="jquery.js"></script>
		<script type="text/javascript" src="dynsections.js"></script>
		<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
		<link href="doxygen.css" rel="stylesheet" type="text/css" />
		<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="custom_dark_theme.css" rel="stylesheet" type="text/css"/>
	</head>
	<body>
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
		<div id="titlearea">
			<table cellspacing="0" cellpadding="0">
				<tbody>
					<tr style="height: 56px;">
						<td id="projectalign" style="padding-left: 0.5em;">
							<div id="projectname">BMSNode
							</div>
							<div id="projectbrief">BMS Node Cell Monitoring Firmware</div>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md__2_users_2joe_2_documents_2_projects_2tronics_2emiata_2bms_2bmsnode_2bmsnode__firmware_2doc_2command.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">BMSNode Command Specification</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This document specifies the BMSNode commands and responses. For details about the packet format, see the [Packet Specification](packet).</p>
<p>All commands are sent with the packet "reply" bit clear, and all responses have the reply bit set.</p>
<h1><a class="anchor" id="autotoc_md17"></a>
PING (1)</h1>
<h2>Command</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Byte   </th><th class="markdownTableHeadNone">Usage    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CMD   </td><td class="markdownTableBodyNone">1    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">LEN   </td><td class="markdownTableBodyNone">0    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PLD   </td><td class="markdownTableBodyNone">None   </td></tr>
</table>
<h2>Response</h2>
<p>With reply bit:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Byte   </th><th class="markdownTableHeadNone">Usage    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CMD   </td><td class="markdownTableBodyNone">1    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">LEN   </td><td class="markdownTableBodyNone">0    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PLD   </td><td class="markdownTableBodyNone">None   </td></tr>
</table>
<h2>Description</h2>
<p>The PING command is used for aliveness and device discovery. It replies with the same command code to indicate presence on the bus. It also turns on the green LED for 1 second for visual identification.</p>
<h1><a class="anchor" id="autotoc_md18"></a>
DFU (2)</h1>
<h2>Command</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Byte   </th><th class="markdownTableHeadNone">Usage    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CMD   </td><td class="markdownTableBodyNone">2    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">LEN   </td><td class="markdownTableBodyNone">0    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PLD   </td><td class="markdownTableBodyNone">None   </td></tr>
</table>
<h2>Response</h2>
<p>The DFU command does not have a reply.</p>
<h2>Description</h2>
<p>Upon receiving this command the node enters DFU mode (boot loader running). At this point it is awaiting boot loader commands. If no boot loader commands are received within a timeout period (4 seconds at the time of this writing), the the firmware restarts.</p>
<p>The boot loader is (mostly) Arduino compatible <a href="https://gitlab.com/kroesche/bmsnode/-/blob/master/build/optiboot/README.md">Optiboot</a>. However, it has been modified to work using serial half-duplex. This modification is needed for the boot loader to work with the BMS Node serial hardware. Because of this, the normal tool for boot loading, <a href="https://www.nongnu.org/avrdude/">avrdude</a>, is not compatible. A python tool called <code>bmsloader.py</code> is provided in the utilities directory.</p>
<h1><a class="anchor" id="autotoc_md19"></a>
UID (3)</h1>
<h2>Command</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Byte   </th><th class="markdownTableHeadNone">Usage    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CMD   </td><td class="markdownTableBodyNone">3    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">LEN   </td><td class="markdownTableBodyNone">0    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PLD   </td><td class="markdownTableBodyNone">None   </td></tr>
</table>
<h2>Response</h2>
<p>With reply bit:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Byte   </th><th class="markdownTableHeadNone">Usage    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CMD   </td><td class="markdownTableBodyNone">3    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">LEN   </td><td class="markdownTableBodyNone">8    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PLD[0:3]   </td><td class="markdownTableBodyNone">32-bit UID, little-endian    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">PLD[4]   </td><td class="markdownTableBodyNone">board type    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PLD[5]   </td><td class="markdownTableBodyNone">firmware major version    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">PLD[6]   </td><td class="markdownTableBodyNone">firmware minor version    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PLD[7]   </td><td class="markdownTableBodyNone">firmware patch version   </td></tr>
</table>
<h2>Description</h2>
<p>The UID command is used to discover the unique ID (UID) for a board. It also returns the board type and the firmware version.</p>
<p><b>Board Types</b></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">OSHPark v4 first prototype boards    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">Stuart v4.2 small batch proto (w/incorrect thermistor)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">BMSNode v1 redesign prototypes    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">4   </td><td class="markdownTableBodyNone">BMSNode v1 small production lot from JLCPCB    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">5   </td><td class="markdownTableBodyNone">BMSNode v2   </td></tr>
</table>
<p><b>NOTE:</b> A BMSNode will accept and respond to this command at address 0, if the BMSNode does not have already assigned a bus address. This command can be used to discover the UID of a fresh device that has never had a bus address assigned. If there is more than one device on the bus that meets this criteria, then the likely results will be garbled packets.</p>
<p>The expected usage is to attach a fresh device to a bus, use this command to find the UID, then use the UID to set a new bus address using the ADDR command.</p>
<h1><a class="anchor" id="autotoc_md20"></a>
ADDR (4)</h1>
<h2>Command</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Byte   </th><th class="markdownTableHeadNone">Usage    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CMD   </td><td class="markdownTableBodyNone">4    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">LEN   </td><td class="markdownTableBodyNone">4    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PLD[0:3]   </td><td class="markdownTableBodyNone">32-bit UID, little-endian   </td></tr>
</table>
<h2>Response</h2>
<p>With reply bit:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Byte   </th><th class="markdownTableHeadNone">Usage    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CMD   </td><td class="markdownTableBodyNone">4    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">LEN   </td><td class="markdownTableBodyNone">4    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PLD[0:3]   </td><td class="markdownTableBodyNone">32-bit UID, little-endian   </td></tr>
</table>
<h2>Description</h2>
<p>The ADDR command is used to set the bus address for a BMSNode. This command is unlike other commands in that it uses the UID to match the node, and the packet address field to specify the new bus address.</p>
<p>When a node receives a ADDR packet, it checks its own UID to match the packet. If the UID does not match, <em>the node does not respond, even if it already has a matching bus address</em>. This means that it is possible to assign the same bus address to different nodes on the same bus. This behavior makes it possible for a controller to assign bus addresses to all devices on a bus without regard to any already-assigned bus addresses. To do this, the controller must know the UID of all devices on the bus.</p>
<h1><a class="anchor" id="autotoc_md21"></a>
ADCRAW (5)</h1>
<h2>Version Notes</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Version   </th><th class="markdownTableHeadNone">Notes    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>0.5</code>   </td><td class="markdownTableBodyNone">command introduced    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>0.11</code>   </td><td class="markdownTableBodyNone">added MCU temperature raw data   </td></tr>
</table>
<h2>Command</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Byte   </th><th class="markdownTableHeadNone">Usage    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CMD   </td><td class="markdownTableBodyNone">5    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">LEN   </td><td class="markdownTableBodyNone">0    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PLD   </td><td class="markdownTableBodyNone">None   </td></tr>
</table>
<h2>Response</h2>
<p>With reply bit:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Byte   </th><th class="markdownTableHeadNone">Usage    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CMD   </td><td class="markdownTableBodyNone">5    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">LEN   </td><td class="markdownTableBodyNone">8    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PLD[1:0]   </td><td class="markdownTableBodyNone">Cell voltage sample data    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">PLD[3:2]   </td><td class="markdownTableBodyNone">Onboard thermistor sample    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PLD[5:4]   </td><td class="markdownTableBodyNone">External sensor sample    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">PLD[7:6]   </td><td class="markdownTableBodyNone">MCU temperature sample   </td></tr>
</table>
<h2>Description</h2>
<p>The ADCRAW command is used to retrieve the raw sample data from the ADC module. The data is 10-bit unsigned, stored in two 8-bit values. The data is little- endian. For example PLD[0] is the lower byte and PLD[1] is the upper byte of the cell voltage sample.</p>
<h2>Notes</h2>
<p>The length of this response packet could increase in the future if more analog samples are collected. However, it should remain backwards-compatible.</p>
<h1><a class="anchor" id="autotoc_md22"></a>
STATUS (6)</h1>
<h2>Version Notes</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Version   </th><th class="markdownTableHeadNone">Notes    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>0.5</code>   </td><td class="markdownTableBodyNone">command introduced    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>0.6</code>   </td><td class="markdownTableBodyNone">added shunt flag and fault    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>0.7</code>   </td><td class="markdownTableBodyNone">replaced shunt flag and fault with single shunt status byte    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>0.10</code>   </td><td class="markdownTableBodyNone">added shunt PWM data item to reply packet    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>0.11</code>   </td><td class="markdownTableBodyNone">added external and internal (MCU) temperatures   </td></tr>
</table>
<h2>Command</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Byte   </th><th class="markdownTableHeadNone">Usage    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CMD   </td><td class="markdownTableBodyNone">6    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">LEN   </td><td class="markdownTableBodyNone">0    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PLD   </td><td class="markdownTableBodyNone">None   </td></tr>
</table>
<h2>Response</h2>
<p>With reply bit:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Byte   </th><th class="markdownTableHeadNone">Usage    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CMD   </td><td class="markdownTableBodyNone">6    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">LEN   </td><td class="markdownTableBodyNone">10    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PLD[1:0]   </td><td class="markdownTableBodyNone">Cell voltage millivolts, little-endian    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">PLD[3:2]   </td><td class="markdownTableBodyNone">Board temperature in C, signed, little-endian    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PLD[4]   </td><td class="markdownTableBodyNone">Shunt status    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">PLD[5]   </td><td class="markdownTableBodyNone">Shunt PWM value (0-255)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PLD[7:6]   </td><td class="markdownTableBodyNone">External temperature in C, signed, little-endian    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">PLD[9:8]   </td><td class="markdownTableBodyNone">Internal temperature in C, signed, little-endian   </td></tr>
</table>
<h2>Description</h2>
<p>The STATUS command is used to retrieve operating data from the BMS Node. This command is WIP and subject to change.</p>
<p>The shunt status field shows the current status of the shunt process.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Shunt Status   </th><th class="markdownTableHeadNone">Reason    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">OFF - turned off    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">IDLE - enabled but not shunting    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">ON - shunt resistors turned on    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">UNUSED - (old UNDERVOLT no longer used)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">4   </td><td class="markdownTableBodyNone">LIMIT - PWM limited due to temperature   </td></tr>
</table>
<p>The shunt PWM field is the duty cycle of the PWM, out of 255. For example, a value of 128 means 50% duty cycle.</p>
<h1><a class="anchor" id="autotoc_md23"></a>
SHUNTON (7)</h1>
<h2>Version Notes</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Version   </th><th class="markdownTableHeadNone">Notes    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>0.6</code>   </td><td class="markdownTableBodyNone">command introduced    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>0.10</code>   </td><td class="markdownTableBodyNone">behavior changed, description updated   </td></tr>
</table>
<h2>Command</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Byte   </th><th class="markdownTableHeadNone">Usage    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CMD   </td><td class="markdownTableBodyNone">7    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">LEN   </td><td class="markdownTableBodyNone">0    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PLD   </td><td class="markdownTableBodyNone">None   </td></tr>
</table>
<h2>Response</h2>
<p>With reply bit:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Byte   </th><th class="markdownTableHeadNone">Usage    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CMD   </td><td class="markdownTableBodyNone">7    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">LEN   </td><td class="markdownTableBodyNone">0    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PLD   </td><td class="markdownTableBodyNone">None   </td></tr>
</table>
<h2>Description</h2>
<p>Turns on the BMS Node cell shunting mode (balancing mode). The BMS Node will turn on the shunt resistor to drain energy from the cell, as a percentage according to a simple linear algorithm.</p>
<p>When the cell voltage is below the <code>SHUNTMIN</code> parameter value, the shunt power is fully off (0%).</p>
<p>When the cell voltage is above the <code>SHUNTMAX</code> parameter value, the shunt power is fully on (100%).</p>
<p>When the cell voltage is between these values, the shunt power is a percentage based on range. For example, when the cell voltage is halfway between the lower and upper values, the shunt power will be 50%.</p>
<p>No matter the power level setting determined by the voltage, the actual power may be limited by temperature as described below. The temperature limit always takes precendence over the value determined by voltage.</p>
<p>The shunt power is limited by temperature determined by the <code>TEMPLO</code> and <code>TEMPHI</code> parameters. When the temperature is below <code>TEMPLO</code>, there is no temperature shunt power limit. When the temperature is above <code>TEMPHI</code> the shunt power is limited to be fully off (0%).</p>
<p>When the temperature is between <code>TEMPLO</code> and <code>TEMPHI</code>, the shunt power is limited according to the temperature range. For example, if the temperature is halfway between the lower and upper temperature limits, then the total shunt power is limited to 50% regardless of the power level determined by the cell voltage.</p>
<p><img src="img/bms-pwm-chart-volts.jpg" alt="" class="inline"/></p>
<p><img src="img/bms-pwm-chart-temp.jpg" alt="" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md24"></a>
SHUNTOFF (8)</h1>
<h2>Version Notes</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Version   </th><th class="markdownTableHeadNone">Notes    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>0.6</code>   </td><td class="markdownTableBodyNone">command introduced   </td></tr>
</table>
<h2>Command</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Byte   </th><th class="markdownTableHeadNone">Usage    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CMD   </td><td class="markdownTableBodyNone">8    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">LEN   </td><td class="markdownTableBodyNone">0    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PLD   </td><td class="markdownTableBodyNone">None   </td></tr>
</table>
<h2>Response</h2>
<p>With reply bit:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Byte   </th><th class="markdownTableHeadNone">Usage    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CMD   </td><td class="markdownTableBodyNone">8    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">LEN   </td><td class="markdownTableBodyNone">0    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PLD   </td><td class="markdownTableBodyNone">None   </td></tr>
</table>
<h2>Description</h2>
<p>Turns off the BMS Node cell shunting mode (balancing mode).</p>
<h1><a class="anchor" id="autotoc_md25"></a>
SETPARM (9)</h1>
<h2>Version Notes</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Version   </th><th class="markdownTableHeadNone">Notes    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>0.7</code>   </td><td class="markdownTableBodyNone">command introduced    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>0.10</code>   </td><td class="markdownTableBodyNone">changes to SHUNTMAX, SHUNTMIN, TEMPLO, TEMPHI, deprecated SHUNTTIME   </td></tr>
</table>
<h2>Command</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Byte   </th><th class="markdownTableHeadNone">Usage    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CMD   </td><td class="markdownTableBodyNone">9    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">LEN   </td><td class="markdownTableBodyNone">2+ (at least 2 bytes)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PLD[0]   </td><td class="markdownTableBodyNone">parameter ID    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">PLD[1]   </td><td class="markdownTableBodyNone">first byte of parameter value    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PLD[N]   </td><td class="markdownTableBodyNone">additional bytes of parm value   </td></tr>
</table>
<h2>Response</h2>
<p>With reply bit:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Byte   </th><th class="markdownTableHeadNone">Usage    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CMD   </td><td class="markdownTableBodyNone">9    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">LEN   </td><td class="markdownTableBodyNone">1    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PLD[0]   </td><td class="markdownTableBodyNone">parameter ID   </td></tr>
</table>
<h2>Description</h2>
<p>Sets the value of a configuration parameter. The parameter ID is specified as the first byte of the payload, and following bytes represent the parameter value. The meaning of the bytes depend on which parameter is selected.</p>
<p>The following table summarizes the configuration parameters. See the following sections for details. Items marker TBD are placeholders and not yet implemented.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">ID   </th><th class="markdownTableHeadNone">Name   </th><th class="markdownTableHeadNone">Len   </th><th class="markdownTableHeadNone">Default   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">ADDR   </td><td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">None   </td><td class="markdownTableBodyNone">node address (read-only)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">VSCALE   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">4400   </td><td class="markdownTableBodyNone">cell voltage calibration scaler    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">VOFFSET   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">cell voltage calibration offset    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">4   </td><td class="markdownTableBodyNone">TSCALE   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">(TBD) temp sensor calibration scaler    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">5   </td><td class="markdownTableBodyNone">TOFFSET   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">(TBD) temp sensor calibration offset    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">6   </td><td class="markdownTableBodyNone">XSCALE   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">(TBD) external sensor calibration scaler    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">7   </td><td class="markdownTableBodyNone">XOFFSET   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">(TBD) external sensor calibration offset    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">8   </td><td class="markdownTableBodyNone">SHUNTMAX   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">4100   </td><td class="markdownTableBodyNone">voltage above which shunting is fully on    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">9   </td><td class="markdownTableBodyNone">SHUNTMIN   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">3900   </td><td class="markdownTableBodyNone">voltage below which shunting is full off    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">10   </td><td class="markdownTableBodyNone">unused   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">-   </td><td class="markdownTableBodyNone">deprecated shunt inactivity timeout    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">11   </td><td class="markdownTableBodyNone">TEMPHI   </td><td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">50   </td><td class="markdownTableBodyNone">upper limit for temperature regulation    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">12   </td><td class="markdownTableBodyNone">TEMPLO   </td><td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">40   </td><td class="markdownTableBodyNone">lower limit for temperature regulation    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">13   </td><td class="markdownTableBodyNone">TEMPADJ   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">(TBD)temperature regulation adjustment factor   </td></tr>
</table>
<h3>Parameter ADDR</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Name   </th><th class="markdownTableHeadNone">Len   </th><th class="markdownTableHeadNone">PLD[0]    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">ADDR   </td><td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">8-bit node address   </td></tr>
</table>
<h4>Notes</h4>
<p>This parameter should be read-only, but this is not enforced by firmware. Therefore, the controller can set the board address using SETPARM with this parameter. However, the reply packet will have the new address which will appear to be an error or non-response from the board.</p>
<p><b>SETPARM should not be used to set the address parameter.</b> Use the <code>ADDR</code> command instead.</p>
<h3>Parameter VSCALE</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Name   </th><th class="markdownTableHeadNone">Len   </th><th class="markdownTableHeadNone">PLD[0]   </th><th class="markdownTableHeadNone">PLD[1]    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">VSCALE   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">low byte   </td><td class="markdownTableBodyNone">high byte   </td></tr>
</table>
<h4>Default Value</h4>
<p><code>4400</code></p>
<h4>Notes</h4>
<p>This parameter is a 16-bit unsigned calibration scaler applied when calculating the cell voltage.</p>
<p>This parameter is multipled by the cell voltage ADC value to convert the ADC value to millivolts. For purposes of fixed point math, this value is multiplied by 1024 prior to the conversion, and then divided by 1024 later.</p>
<p>This parameter provides linear scaling. It is used along with <code>VOFFSET</code> to get the final converted millivolts value.</p>
<p>The formula below shows how to get cell millivolts from the ADC value and includes using the VSCALE and VOFFSET parameters. </p><pre class="fragment">Cell mV = ((ADC * VSCALE) / 1024) + VOFFSET
</pre> <h3>Parameter VOFFSET</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Name   </th><th class="markdownTableHeadNone">Len   </th><th class="markdownTableHeadNone">PLD[0]   </th><th class="markdownTableHeadNone">PLD[1]    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">VOFFSET   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">low byte   </td><td class="markdownTableBodyNone">high byte   </td></tr>
</table>
<h4>Default Value</h4>
<p><code>0 mV</code></p>
<h4>Notes</h4>
<p>This parameter is a 16-bit signed calibration offset, in millivolts, applied when calculating the cell voltage.</p>
<p>See the <code>VSCALE</code> parameter for a description of the conversion formula.</p>
<h3>Parameter TSCALE</h3>
<p><b>TBD</b></p>
<h3>Parameter TOFFSET</h3>
<p><b>TBD</b></p>
<h3>Parameter XSCALE</h3>
<p><b>TBD</b></p>
<h3>Parameter XOFFSET</h3>
<p><b>TBD</b></p>
<h3>Parameter SHUNTMAX</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Name   </th><th class="markdownTableHeadNone">Len   </th><th class="markdownTableHeadNone">PLD[0]   </th><th class="markdownTableHeadNone">PLD[1]    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">SHUNTMAX   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">low byte   </td><td class="markdownTableBodyNone">high byte   </td></tr>
</table>
<h4>Version Notes</h4>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Version   </th><th class="markdownTableHeadNone">Notes    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>0.10</code>   </td><td class="markdownTableBodyNone">changed from SHUNTON to SHUNTMAX   </td></tr>
</table>
<h4>Default Value</h4>
<p><code>4100 mV</code></p>
<h4>Notes</h4>
<p>This parameter is 16-bit unsigned millivolts and is the upper end of the voltage range defined by <code>SHUNTMIN</code> and <code>SHUNTMAX</code>. This range is used to determine the shunt power percentage. When the cell voltage is above this limit, the shunt power is fully on (100% duty cycle).</p>
<p>This value must always be greater that <code>SHUNTMIN</code>.</p>
<h3>Parameter SHUNTMIN</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Name   </th><th class="markdownTableHeadNone">Len   </th><th class="markdownTableHeadNone">PLD[0]   </th><th class="markdownTableHeadNone">PLD[1]    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">SHUNTMIN   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">low byte   </td><td class="markdownTableBodyNone">high byte   </td></tr>
</table>
<h4>Version Notes</h4>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Version   </th><th class="markdownTableHeadNone">Notes    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>0.10</code>   </td><td class="markdownTableBodyNone">changed from SHUNTOFF to SHUNTMIN   </td></tr>
</table>
<h4>Default Value</h4>
<p><code>3900 mV</code></p>
<h4>Notes</h4>
<p>This parameter is 16-bit unsigned millivolts and is the lower end of the voltage range defined by <code>SHUNTMIN</code> and <code>SHUNTMAX</code>. This range is used to determine the shunt power percentage. When the cell voltage is below this limit, the shunt power is fully off (0% duty cycle).</p>
<h3>Parameter (deprecated) SHUNTTIME</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Name   </th><th class="markdownTableHeadNone">Len   </th><th class="markdownTableHeadNone">PLD[0]   </th><th class="markdownTableHeadNone">PLD[1]    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">SHUNTTIME   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">low byte   </td><td class="markdownTableBodyNone">high byte   </td></tr>
</table>
<h4>Version Notes</h4>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Version   </th><th class="markdownTableHeadNone">Notes    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>0.10</code>   </td><td class="markdownTableBodyNone">deprecated from use   </td></tr>
</table>
<h4>Default Value</h4>
<p>N/A</p>
<h4>Notes</h4>
<p>This was previously used to set a shunt idle timeout. It is no longer used. The shunt idle timeout is permanently fixed at 30 seconds.</p>
<h3>Parameter TEMPHI</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Name   </th><th class="markdownTableHeadNone">Len   </th><th class="markdownTableHeadNone">PLD[0]    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TEMPHI   </td><td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">8-bit signed temperature limit   </td></tr>
</table>
<h4>Version Notes</h4>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Version   </th><th class="markdownTableHeadNone">Notes    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>0.10</code>   </td><td class="markdownTableBodyNone">description updated to describe shunt power temperature limit   </td></tr>
</table>
<h4>Default Value</h4>
<p><code>50 C</code></p>
<h4>Notes</h4>
<p>This parameter is an 8-bit signed temperature value, in C. This parameter works with <code>TEMPLO</code> to define a temperature range use to limit shunt power. When the temperature is above this value, shunt power is limited to fully off.</p>
<h3>Parameter TEMPLO</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Name   </th><th class="markdownTableHeadNone">Len   </th><th class="markdownTableHeadNone">PLD[0]    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TEMPLO   </td><td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">8-bit signed temperature limit   </td></tr>
</table>
<h4>Version Notes</h4>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Version   </th><th class="markdownTableHeadNone">Notes    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>0.10</code>   </td><td class="markdownTableBodyNone">description updated to describe shunt power temperature limit   </td></tr>
</table>
<h4>Default Value</h4>
<p><code>40 C</code></p>
<h4>Notes</h4>
<p>This parameter is an 8-bit signed temperature value, in C. This parameter works with <code>TEMPHI</code> to define a temperature range use to limit shunt power. When the temperature is below this value, shunt power is not temperature limited.</p>
<h3>Parameter TEMPADJ</h3>
<p>TBD</p>
<h1><a class="anchor" id="autotoc_md26"></a>
GETPARM (10)</h1>
<h2>Version Notes</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Version   </th><th class="markdownTableHeadNone">Notes    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>0.7</code>   </td><td class="markdownTableBodyNone">command introduced   </td></tr>
</table>
<h2>Command</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Byte   </th><th class="markdownTableHeadNone">Usage    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CMD   </td><td class="markdownTableBodyNone">10    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">LEN   </td><td class="markdownTableBodyNone">1    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PLD[0]   </td><td class="markdownTableBodyNone">parameter ID   </td></tr>
</table>
<h2>Response</h2>
<p>With reply bit:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Byte   </th><th class="markdownTableHeadNone">Usage    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CMD   </td><td class="markdownTableBodyNone">10    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">LEN   </td><td class="markdownTableBodyNone">2+ (at least 2 bytes)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PLD[0]   </td><td class="markdownTableBodyNone">parameter ID    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">PLD[1]   </td><td class="markdownTableBodyNone">first byte of parameter value    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PLD[N]   </td><td class="markdownTableBodyNone">additional bytes of parm value   </td></tr>
</table>
<h2>Description</h2>
<p>Gets the value of a configuration parameter. The parameter ID is specified as the first byte of the payload. In the reply, the first byte of the payload is the parameter ID, and the following payload bytes represent the parameter value. The meaning of the bytes depend on which parameter is selected.</p>
<p>See the <em>SETPARM</em> command for detailed descriptions of the parameters.</p>
<h1><a class="anchor" id="autotoc_md27"></a>
TESTMODE (11)</h1>
<h2>Version Notes</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Version   </th><th class="markdownTableHeadNone">Notes    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>0.9</code>   </td><td class="markdownTableBodyNone">command introduced    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>0.10</code>   </td><td class="markdownTableBodyNone">added value fields to command   </td></tr>
</table>
<h2>Command</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Byte   </th><th class="markdownTableHeadNone">Usage    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CMD   </td><td class="markdownTableBodyNone">11    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">LEN   </td><td class="markdownTableBodyNone">5    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PLD[0]   </td><td class="markdownTableBodyNone">test function    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">PLD[1]   </td><td class="markdownTableBodyNone">test key 1    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PLD[2]   </td><td class="markdownTableBodyNone">test key 2    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">PLD[3]   </td><td class="markdownTableBodyNone">test value 0    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PLD[4]   </td><td class="markdownTableBodyNone">test value 1   </td></tr>
</table>
<h2>Response</h2>
<p>With reply bit:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Byte   </th><th class="markdownTableHeadNone">Usage    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CMD   </td><td class="markdownTableBodyNone">11    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">LEN   </td><td class="markdownTableBodyNone">0    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PLD   </td><td class="markdownTableBodyNone">None   </td></tr>
</table>
<h2>Description</h2>
<p>Places the BMSNode into one of several test modes. The first byte of the payload is the test function code. The next two bytes are a fixed key value that must be passed in the command. The value of the key bytes is: <code>0xCA, 0xFE</code>.</p>
<p>The next two bytes are values that are used depending on the test mode. As of <code>0.10</code> only test value 0 is used for the shunt test mode.</p>
<p>A single function code is used to turn off any active test mode and the key does not have to match. For all remaining test function codes, the key must match. If the test function is not turned off by command, it will be automatically turned off after 60 seconds.</p>
<p>Only one test function can be active at a time. While a test function is active, the device does not sleep (does not go to low power). While a test function is active, other commands do not work. (TODO: Verify this)</p>
<p><b>Test Function Codes</b></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Code   </th><th class="markdownTableHeadNone">Test Function    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">turn off test function    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">turn on Vref    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">turn on external IO    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">turn on shunt resistor    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">4   </td><td class="markdownTableBodyNone">blink LEDs   </td></tr>
</table>
<h3>Shunt Test Mode</h3>
<p>For shunt test mode, pass in the PWM setting in test value 0. Test value 1 must be 0. The PWM setting is out of 255. For example to set 50% PWM use a value of 128.</p>
<p><b>WARNING:</b> when shunt test mode is used there is no thermal regulation. It is meant to be used for quick testing and not for extended use. Do not repeatedly activate shunt test mode without robust temperature monitoring.</p>
<h1><a class="anchor" id="autotoc_md28"></a>
FACTORY (12)</h1>
<h2>Version Notes</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Version   </th><th class="markdownTableHeadNone">Notes    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>0.10.3</code>   </td><td class="markdownTableBodyNone">command introduced   </td></tr>
</table>
<h2>Command</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Byte   </th><th class="markdownTableHeadNone">Usage    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CMD   </td><td class="markdownTableBodyNone">12    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">LEN   </td><td class="markdownTableBodyNone">0    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PLD   </td><td class="markdownTableBodyNone">None   </td></tr>
</table>
<h2>Response</h2>
<p>With reply bit:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Byte   </th><th class="markdownTableHeadNone">Usage    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CMD   </td><td class="markdownTableBodyNone">12    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">LEN   </td><td class="markdownTableBodyNone">0    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PLD   </td><td class="markdownTableBodyNone">None   </td></tr>
</table>
<h2>Description</h2>
<p>Resets the BMSNode configuration to the factory default values.</p>
<p><b>WARNING:</b></p>
<p><em>This will cause the BMSNode to lose it's BUS ID. It will be reset to 0. This means that the reply packet will have an address of 0 instead of the Bus ID that was used for the command. This might appear to be a non-reply if the controller is not expecting it.</em></p>
<p>You will need to (re)assign the Bus ID after this.</p>
<p>All calibration parameters will be reset to defaults. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
		<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
			<ul>
				<li class="footer">
					Generated on Wed Jan 22 2025 15:43:06 for BMSNode by <a href="http://www.doxygen.org/index.html">
					<img class="footer" src="doxygen.png" alt="doxygen"
                     onerror="this.onerror=null;this.src='doxygen.svg';"/></a> 1.11.0.
					Dark theme by <a href="http://majerle.eu" target="_new">Tilen Majerle</a>. All rights reserved.
				</li>
			</ul>
		</div>
		<script src="custom.js"></script>
	</body>
</html>

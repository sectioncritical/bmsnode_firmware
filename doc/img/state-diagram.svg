<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: state transitions Pages: 1 -->
<svg width="797pt" height="617pt"
 viewBox="0.00 0.00 797.18 617.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 613)">
<title>state transitions</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-613 793.184,-613 793.184,4 -4,4"/>
<!-- hwstart -->
<g id="node1" class="node">
<title>hwstart</title>
<polygon fill="transparent" stroke="transparent" stroke-width="2" points="289.184,-609 163.184,-609 163.184,-483 289.184,-483 289.184,-609"/>
<text text-anchor="start" x="206.8496" y="-592.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">hwstart</text>
<text text-anchor="start" x="169.184" y="-572.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">init hw</text>
<text text-anchor="start" x="169.184" y="-552.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">init modules</text>
<text text-anchor="start" x="169.184" y="-532.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">load config</text>
<text text-anchor="start" x="169.184" y="-512.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">ADC powerup</text>
<text text-anchor="start" x="168.8366" y="-492.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">exit/ enable interrupts</text>
<polygon fill="#000000" stroke="#000000" points="163.184,-586 163.184,-586 289.184,-586 289.184,-586 163.184,-586"/>
<path fill="none" stroke="#000000" stroke-width="2" d="M176.184,-484C176.184,-484 276.184,-484 276.184,-484 282.184,-484 288.184,-490 288.184,-496 288.184,-496 288.184,-596 288.184,-596 288.184,-602 282.184,-608 276.184,-608 276.184,-608 176.184,-608 176.184,-608 170.184,-608 164.184,-602 164.184,-596 164.184,-596 164.184,-496 164.184,-496 164.184,-490 170.184,-484 176.184,-484"/>
</g>
<!-- powerup -->
<g id="node2" class="node">
<title>powerup</title>
<polygon fill="transparent" stroke="transparent" stroke-width="2" points="462.184,-455 326.184,-455 326.184,-389 462.184,-389 462.184,-455"/>
<text text-anchor="start" x="371.1782" y="-438.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">powerup</text>
<text text-anchor="start" x="332.184" y="-418.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">entry/ blue blink 50</text>
<text text-anchor="start" x="331.8338" y="-398.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">entry/ idle timeout 1000</text>
<polygon fill="#000000" stroke="#000000" points="326.184,-432 326.184,-432 462.184,-432 462.184,-432 326.184,-432"/>
<path fill="none" stroke="#000000" stroke-width="2" d="M339.184,-390C339.184,-390 449.184,-390 449.184,-390 455.184,-390 461.184,-396 461.184,-402 461.184,-402 461.184,-442 461.184,-442 461.184,-448 455.184,-454 449.184,-454 449.184,-454 339.184,-454 339.184,-454 333.184,-454 327.184,-448 327.184,-442 327.184,-442 327.184,-402 327.184,-402 327.184,-396 333.184,-390 339.184,-390"/>
</g>
<!-- hwstart&#45;&gt;powerup -->
<g id="edge3" class="edge">
<title>hwstart&#45;&gt;powerup</title>
<path fill="none" stroke="#000000" d="M289.219,-499.4742C306.2655,-486.8922 324.5426,-473.4019 340.9905,-461.2619"/>
<polygon fill="#000000" stroke="#000000" points="343.4415,-463.803 349.4088,-455.0484 339.2845,-458.1709 343.4415,-463.803"/>
<text text-anchor="middle" x="336.5735" y="-466" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000"> </text>
</g>
<!-- note_hwstart -->
<g id="node8" class="node">
<title>note_hwstart</title>
<polygon fill="#ffffcc" stroke="#000000" points="298.628,-440 109.74,-440 109.74,-404 304.628,-404 304.628,-434 298.628,-440"/>
<polyline fill="none" stroke="#000000" points="298.628,-440 298.628,-434 "/>
<polyline fill="none" stroke="#000000" points="304.628,-434 298.628,-434 "/>
<text text-anchor="start" x="117.712" y="-425" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">This is performed by the main init code</text>
<text text-anchor="start" x="117.712" y="-413" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">and not actually implemented as a state.</text>
</g>
<!-- hwstart&#45;&gt;note_hwstart -->
<g id="edge1" class="edge">
<title>hwstart&#45;&gt;note_hwstart</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M216.517,-482.9102C214.1152,-467.235 211.7276,-451.6527 209.9685,-440.1728"/>
</g>
<!-- idle -->
<g id="node3" class="node">
<title>idle</title>
<polygon fill="transparent" stroke="transparent" stroke-width="2" points="462.184,-361 326.184,-361 326.184,-255 462.184,-255 462.184,-361"/>
<text text-anchor="start" x="384.8504" y="-344.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">idle</text>
<text text-anchor="start" x="332.184" y="-324.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">entry/ blue blink 200</text>
<text text-anchor="start" x="331.8338" y="-304.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">entry/ idle timeout 1000</text>
<text text-anchor="start" x="332.184" y="-284.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">if activity</text>
<text text-anchor="start" x="332.184" y="-264.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">then idle timeout 1000</text>
<polygon fill="#000000" stroke="#000000" points="326.184,-338 326.184,-338 462.184,-338 462.184,-338 326.184,-338"/>
<path fill="none" stroke="#000000" stroke-width="2" d="M339.184,-256C339.184,-256 449.184,-256 449.184,-256 455.184,-256 461.184,-262 461.184,-268 461.184,-268 461.184,-348 461.184,-348 461.184,-354 455.184,-360 449.184,-360 449.184,-360 339.184,-360 339.184,-360 333.184,-360 327.184,-354 327.184,-348 327.184,-348 327.184,-268 327.184,-268 327.184,-262 333.184,-256 339.184,-256"/>
</g>
<!-- powerup&#45;&gt;idle -->
<g id="edge4" class="edge">
<title>powerup&#45;&gt;idle</title>
<path fill="none" stroke="#000000" d="M394.184,-388.72C394.184,-383.1626 394.184,-377.239 394.184,-371.2218"/>
<polygon fill="#000000" stroke="#000000" points="397.6841,-371.055 394.184,-361.055 390.6841,-371.055 397.6841,-371.055"/>
<text text-anchor="start" x="394.184" y="-372" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">idle timeout &#160;&#160;</text>
</g>
<!-- idle&#45;&gt;idle -->
<g id="edge5" class="edge">
<title>idle&#45;&gt;idle</title>
<path fill="none" stroke="#000000" d="M462.4698,-319.7398C475.2109,-318.2941 484.184,-314.3809 484.184,-308 484.184,-303.5135 479.7478,-300.2469 472.6849,-298.2002"/>
<polygon fill="#000000" stroke="#000000" points="472.9473,-294.6875 462.4698,-296.2602 471.6412,-301.5646 472.9473,-294.6875"/>
<text text-anchor="start" x="484.184" y="-305" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">CMD_PING/green oneshot 1000 &#160;&#160;</text>
</g>
<!-- dfu -->
<g id="node4" class="node">
<title>dfu</title>
<polygon fill="transparent" stroke="transparent" stroke-width="2" points="160.184,-177 24.184,-177 24.184,-111 160.184,-111 160.184,-177"/>
<text text-anchor="start" x="83.8458" y="-160.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">dfu</text>
<text text-anchor="start" x="30.184" y="-140.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">entry/ blue blink 1000</text>
<text text-anchor="start" x="29.8338" y="-120.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">entry/ idle timeout 8000</text>
<polygon fill="#000000" stroke="#000000" points="24.184,-154 24.184,-154 160.184,-154 160.184,-154 24.184,-154"/>
<path fill="none" stroke="#000000" stroke-width="2" d="M37.184,-112C37.184,-112 147.184,-112 147.184,-112 153.184,-112 159.184,-118 159.184,-124 159.184,-124 159.184,-164 159.184,-164 159.184,-170 153.184,-176 147.184,-176 147.184,-176 37.184,-176 37.184,-176 31.184,-176 25.184,-170 25.184,-164 25.184,-164 25.184,-124 25.184,-124 25.184,-118 31.184,-112 37.184,-112"/>
</g>
<!-- idle&#45;&gt;dfu -->
<g id="edge6" class="edge">
<title>idle&#45;&gt;dfu</title>
<path fill="none" stroke="#000000" d="M326.1835,-305.6435C237.7531,-300.9837 90.5855,-287.2372 56.974,-247 42.5157,-229.6916 49.1891,-206.137 60.4344,-185.9212"/>
<polygon fill="#000000" stroke="#000000" points="63.5257,-187.5718 65.6733,-177.1969 57.5246,-183.9681 63.5257,-187.5718"/>
<text text-anchor="start" x="57.184" y="-238" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">CMD_DFU &#160;&#160;</text>
</g>
<!-- shunt -->
<g id="node5" class="node">
<title>shunt</title>
<polygon fill="transparent" stroke="transparent" stroke-width="2" points="327.184,-227 187.184,-227 187.184,-61 327.184,-61 327.184,-227"/>
<text text-anchor="start" x="242.5104" y="-210.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">shunt</text>
<text text-anchor="start" x="192.8394" y="-190.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">entry/ enable WDT 1sec</text>
<text text-anchor="start" x="193.184" y="-170.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">entry/ init shuntmode</text>
<text text-anchor="start" x="193.184" y="-150.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">pet watchdog</text>
<text text-anchor="start" x="193.184" y="-130.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">run shuntmode</text>
<text text-anchor="start" x="193.184" y="-110.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">if CMD_SHUNTOFF</text>
<text text-anchor="start" x="193.184" y="-90.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">then shunt off</text>
<text text-anchor="start" x="193.184" y="-70.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">exit/ disable WDT</text>
<polygon fill="#000000" stroke="#000000" points="187.184,-204 187.184,-204 327.184,-204 327.184,-204 187.184,-204"/>
<path fill="none" stroke="#000000" stroke-width="2" d="M200.184,-62C200.184,-62 314.184,-62 314.184,-62 320.184,-62 326.184,-68 326.184,-74 326.184,-74 326.184,-214 326.184,-214 326.184,-220 320.184,-226 314.184,-226 314.184,-226 200.184,-226 200.184,-226 194.184,-226 188.184,-220 188.184,-214 188.184,-214 188.184,-74 188.184,-74 188.184,-68 194.184,-62 200.184,-62"/>
</g>
<!-- idle&#45;&gt;shunt -->
<g id="edge8" class="edge">
<title>idle&#45;&gt;shunt</title>
<path fill="none" stroke="#000000" d="M325.942,-291.5734C285.1907,-280.2296 239.0806,-264.1447 227.088,-247 224.8856,-243.8515 223.2335,-240.5417 222.0572,-237.1171"/>
<polygon fill="#000000" stroke="#000000" points="225.4509,-236.2494 219.9403,-227.2005 218.6051,-237.7108 225.4509,-236.2494"/>
<text text-anchor="start" x="227.184" y="-238" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">CMD_SHUNTON &#160;&#160;</text>
</g>
<!-- test -->
<g id="node6" class="node">
<title>test</title>
<polygon fill="transparent" stroke="transparent" stroke-width="2" points="544.184,-197 404.184,-197 404.184,-91 544.184,-91 544.184,-197"/>
<text text-anchor="start" x="464.5138" y="-180.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">test</text>
<text text-anchor="start" x="409.8394" y="-160.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">entry/ enable WDT 1sec</text>
<text text-anchor="start" x="410.184" y="-140.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">pet watchdog</text>
<text text-anchor="start" x="410.184" y="-120.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">run testmode</text>
<text text-anchor="start" x="410.184" y="-100.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">exit/ disable WDT</text>
<polygon fill="#000000" stroke="#000000" points="404.184,-174 404.184,-174 544.184,-174 544.184,-174 404.184,-174"/>
<path fill="none" stroke="#000000" stroke-width="2" d="M417.184,-92C417.184,-92 531.184,-92 531.184,-92 537.184,-92 543.184,-98 543.184,-104 543.184,-104 543.184,-184 543.184,-184 543.184,-190 537.184,-196 531.184,-196 531.184,-196 417.184,-196 417.184,-196 411.184,-196 405.184,-190 405.184,-184 405.184,-184 405.184,-104 405.184,-104 405.184,-98 411.184,-92 417.184,-92"/>
</g>
<!-- idle&#45;&gt;test -->
<g id="edge10" class="edge">
<title>idle&#45;&gt;test</title>
<path fill="none" stroke="#000000" d="M420.1577,-254.7539C427.6711,-239.3515 435.9404,-222.3995 443.7021,-206.488"/>
<polygon fill="#000000" stroke="#000000" points="446.9652,-207.7816 448.2038,-197.2594 440.6738,-204.7126 446.9652,-207.7816"/>
<text text-anchor="start" x="430.184" y="-238" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">CMD_TESTMODE &#160;&#160;</text>
</g>
<!-- sleep -->
<g id="node7" class="node">
<title>sleep</title>
<polygon fill="transparent" stroke="transparent" stroke-width="2" points="789.184,-227 635.184,-227 635.184,-61 789.184,-61 789.184,-227"/>
<text text-anchor="start" x="697.8464" y="-210.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">sleep</text>
<text text-anchor="start" x="641.184" y="-190.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">entry/ ADC powerdown</text>
<text text-anchor="start" x="641.184" y="-170.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">entry/ LEDs off</text>
<text text-anchor="start" x="641.184" y="-150.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">entry/ external load off</text>
<text text-anchor="start" x="641.184" y="-130.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">entry/ MCU sleep (pwrdn)</text>
<text text-anchor="start" x="641.177" y="-110.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">remain in pwrdn until wake</text>
<text text-anchor="start" x="641.184" y="-90.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">exit/ blue on</text>
<text text-anchor="start" x="641.184" y="-70.2" font-family="Helvetica,sans-Serif" font-size="12.00" fill="#000000">exit/ ADC powerup</text>
<polygon fill="#000000" stroke="#000000" points="635.184,-204 635.184,-204 789.184,-204 789.184,-204 635.184,-204"/>
<path fill="none" stroke="#000000" stroke-width="2" d="M648.184,-62C648.184,-62 776.184,-62 776.184,-62 782.184,-62 788.184,-68 788.184,-74 788.184,-74 788.184,-214 788.184,-214 788.184,-220 782.184,-226 776.184,-226 776.184,-226 648.184,-226 648.184,-226 642.184,-226 636.184,-220 636.184,-214 636.184,-214 636.184,-74 636.184,-74 636.184,-68 642.184,-62 648.184,-62"/>
</g>
<!-- idle&#45;&gt;sleep -->
<g id="edge12" class="edge">
<title>idle&#45;&gt;sleep</title>
<path fill="none" stroke="#000000" d="M462.3379,-298.2308C507.0075,-289.6382 565.3884,-274.1173 611.184,-247 617.9268,-243.0074 624.5301,-238.452 630.9273,-233.5312"/>
<polygon fill="#000000" stroke="#000000" points="633.3089,-236.1076 638.9152,-227.1176 628.9263,-230.6493 633.3089,-236.1076"/>
<text text-anchor="start" x="628.184" y="-238" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">idle timeout &#160;&#160;</text>
</g>
<!-- dfu&#45;&gt;idle -->
<g id="edge7" class="edge">
<title>dfu&#45;&gt;idle</title>
<path fill="none" stroke="#000000" d="M105.3432,-177.0474C116.122,-199.9726 133.5501,-229.4347 157.729,-247 182.9791,-265.3434 257.3976,-282.7643 316.0763,-294.2563"/>
<polygon fill="#000000" stroke="#000000" points="315.6073,-297.7303 326.0896,-296.1903 316.9349,-290.8573 315.6073,-297.7303"/>
<text text-anchor="start" x="158.184" y="-238" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">idle timeout &#160;&#160;</text>
</g>
<!-- note_dfu -->
<g id="node9" class="node">
<title>note_dfu</title>
<polygon fill="#ffffcc" stroke="#000000" points="178.5524,-44 -.1844,-44 -.1844,0 184.5524,0 184.5524,-38 178.5524,-44"/>
<polyline fill="none" stroke="#000000" points="178.5524,-44 178.5524,-38 "/>
<polyline fill="none" stroke="#000000" points="184.5524,-38 178.5524,-38 "/>
<text text-anchor="start" x="8" y="-31" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">used to keep node awake for at least</text>
<text text-anchor="start" x="8" y="-19" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">8 seconds while DFU is started on the</text>
<text text-anchor="start" x="8" y="-7" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">bus for another node</text>
</g>
<!-- dfu&#45;&gt;note_dfu -->
<g id="edge2" class="edge">
<title>dfu&#45;&gt;note_dfu</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M92.184,-110.985C92.184,-89.8146 92.184,-62.9027 92.184,-44.2459"/>
</g>
<!-- shunt&#45;&gt;idle -->
<g id="edge9" class="edge">
<title>shunt&#45;&gt;idle</title>
<path fill="none" stroke="#000000" d="M321.3967,-227.1087C326.922,-233.8926 332.4815,-240.5966 337.929,-247 338.069,-247.1646 338.2093,-247.3293 338.3499,-247.4943"/>
<polygon fill="#000000" stroke="#000000" points="335.6501,-249.7231 344.8395,-254.9964 340.9443,-245.1435 335.6501,-249.7231"/>
<text text-anchor="start" x="338.184" y="-238" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">shuntmode ends &#160;&#160;</text>
</g>
<!-- test&#45;&gt;idle -->
<g id="edge11" class="edge">
<title>test&#45;&gt;idle</title>
<path fill="none" stroke="#000000" d="M523.7171,-197.2156C533.0946,-213.5528 537.2284,-231.3427 527.184,-247 514.4589,-266.836 493.4904,-280.3061 471.9242,-289.4193"/>
<polygon fill="#000000" stroke="#000000" points="470.3638,-286.2718 462.3355,-293.1854 472.9229,-292.7873 470.3638,-286.2718"/>
<text text-anchor="start" x="532.184" y="-238" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">testmode ends &#160;&#160;</text>
</g>
<!-- sleep&#45;&gt;idle -->
<g id="edge13" class="edge">
<title>sleep&#45;&gt;idle</title>
<path fill="none" stroke="#000000" d="M705.3543,-227.1988C702.1139,-234.5232 697.8227,-241.3039 692.184,-247 662.0505,-277.44 550.4516,-293.7958 472.7292,-301.6942"/>
<polygon fill="#000000" stroke="#000000" points="472.0831,-298.2409 462.4757,-302.7074 472.7715,-305.2069 472.0831,-298.2409"/>
<text text-anchor="start" x="701.184" y="-238" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#000000">hw wake &#160;&#160;</text>
</g>
</g>
</svg>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=9"/>
		<meta name="generator" content="Doxygen 1.11.0"/>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		<title>BMSNode: KeepItSimple State Machine</title>
		<link href="tabs.css" rel="stylesheet" type="text/css"/>
		<script type="text/javascript" src="jquery.js"></script>
		<script type="text/javascript" src="dynsections.js"></script>
		<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
		<link href="doxygen.css" rel="stylesheet" type="text/css" />
		<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="custom_dark_theme.css" rel="stylesheet" type="text/css"/>
	</head>
	<body>
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
		<div id="titlearea">
			<table cellspacing="0" cellpadding="0">
				<tbody>
					<tr style="height: 56px;">
						<td id="projectalign" style="padding-left: 0.5em;">
							<div id="projectname">BMSNode
							</div>
							<div id="projectbrief">BMS Node Cell Monitoring Firmware</div>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('group__kissm.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">KeepItSimple State Machine</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:unionkissm__ptrbytes" id="r_unionkissm__ptrbytes"><td class="memItemLeft" align="right" valign="top">union &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#unionkissm__ptrbytes">kissm_ptrbytes</a></td></tr>
<tr class="memdesc:unionkissm__ptrbytes"><td class="mdescLeft">&#160;</td><td class="mdescRight">Union to allow event data to be pointer or byte data.  <a href="#unionkissm__ptrbytes">More...</a><br /></td></tr>
<tr class="separator:unionkissm__ptrbytes"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structkissm__event" id="r_structkissm__event"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#structkissm__event">kissm_event</a></td></tr>
<tr class="memdesc:structkissm__event"><td class="mdescLeft">&#160;</td><td class="mdescRight">State machine event.  <a href="#structkissm__event">More...</a><br /></td></tr>
<tr class="separator:structkissm__event"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structkissm__state" id="r_structkissm__state"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#structkissm__state">kissm_state</a></td></tr>
<tr class="memdesc:structkissm__state"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines a state "object" which contains all the information about a state.  <a href="#structkissm__state">More...</a><br /></td></tr>
<tr class="separator:structkissm__state"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga14afc9ddc9cd84bf654a666bd7fa582c" id="r_ga14afc9ddc9cd84bf654a666bd7fa582c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga14afc9ddc9cd84bf654a666bd7fa582c">KISSM_STATEREF</a>(s)</td></tr>
<tr class="memdesc:ga14afc9ddc9cd84bf654a666bd7fa582c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a reference to a named state struct.  <br /></td></tr>
<tr class="separator:ga14afc9ddc9cd84bf654a666bd7fa582c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2f02f4ce366579c77578a3a3b4a65581" id="r_ga2f02f4ce366579c77578a3a3b4a65581"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga2f02f4ce366579c77578a3a3b4a65581">KISSM_DECLSTATE</a>(s)</td></tr>
<tr class="memdesc:ga2f02f4ce366579c77578a3a3b4a65581"><td class="mdescLeft">&#160;</td><td class="mdescRight">Declare a state handler and state struct to hold the state details.  <br /></td></tr>
<tr class="separator:ga2f02f4ce366579c77578a3a3b4a65581"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga678f531476a9b2e9ba672b7e2510f8fe" id="r_ga678f531476a9b2e9ba672b7e2510f8fe"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga678f531476a9b2e9ba672b7e2510f8fe">KISSM_DEFSTATE</a>(s)</td></tr>
<tr class="memdesc:ga678f531476a9b2e9ba672b7e2510f8fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">A convenience macro to define a state handler function.  <br /></td></tr>
<tr class="separator:ga678f531476a9b2e9ba672b7e2510f8fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:gab374702413577f1460bbbe65b38a2bfb" id="r_gab374702413577f1460bbbe65b38a2bfb"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gab374702413577f1460bbbe65b38a2bfb">kissm_event_type</a> { <br />
&#160;&#160;<a class="el" href="#ggab374702413577f1460bbbe65b38a2bfbaaed296044899b28ae15be980a2e44b9e">KISSM_EVT_NONE</a>
, <a class="el" href="#ggab374702413577f1460bbbe65b38a2bfba94384bb3aa5705a1993c1465c8c0b085">KISSM_EVT_ANY</a>
, <a class="el" href="#ggab374702413577f1460bbbe65b38a2bfba7f6309089bc79bb6ce3c5d5e7b3ae4d0">KISSM_EVT_EXIT</a>
, <a class="el" href="#ggab374702413577f1460bbbe65b38a2bfba3266aee90c06bb02fa3d4521f13a5302">KISSM_EVT_ENTRY</a>
, <br />
&#160;&#160;<a class="el" href="#ggab374702413577f1460bbbe65b38a2bfbadbd5ab9272e1f54e68046fc0037bdcdc">KISSM_EVT_APP</a>
<br />
 }</td></tr>
<tr class="memdesc:gab374702413577f1460bbbe65b38a2bfb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Predefined event types.  <a href="#gab374702413577f1460bbbe65b38a2bfb">More...</a><br /></td></tr>
<tr class="separator:gab374702413577f1460bbbe65b38a2bfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga5fde8e8926f97dbd2645d237c4fe2a9d" id="r_ga5fde8e8926f97dbd2645d237c4fe2a9d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga5fde8e8926f97dbd2645d237c4fe2a9d">kissm_init</a> (struct <a class="el" href="#structkissm__state">kissm_state</a> *init_state)</td></tr>
<tr class="memdesc:ga5fde8e8926f97dbd2645d237c4fe2a9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the state machine with the application first state.  <br /></td></tr>
<tr class="separator:ga5fde8e8926f97dbd2645d237c4fe2a9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga711e7f57bd7575d29b7bdfcd51716979" id="r_ga711e7f57bd7575d29b7bdfcd51716979"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga711e7f57bd7575d29b7bdfcd51716979">kissm_run</a> (const struct <a class="el" href="#structkissm__event">kissm_event</a> *p_event)</td></tr>
<tr class="memdesc:ga711e7f57bd7575d29b7bdfcd51716979"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run the state machine.  <br /></td></tr>
<tr class="separator:ga711e7f57bd7575d29b7bdfcd51716979"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Example implementation:</p>
<div class="fragment"><div class="line"><span class="comment">// declare app states</span></div>
<div class="line"><a class="code hl_define" href="#ga2f02f4ce366579c77578a3a3b4a65581">KISSM_DECLSTATE</a>(app_start); <span class="comment">// first app state</span></div>
<div class="line"><a class="code hl_define" href="#ga2f02f4ce366579c77578a3a3b4a65581">KISSM_DECLSTATE</a>(appstate1);</div>
<div class="line"><a class="code hl_define" href="#ga2f02f4ce366579c77578a3a3b4a65581">KISSM_DECLSTATE</a>(appstate2);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_define" href="#ga678f531476a9b2e9ba672b7e2510f8fe">KISSM_DEFSTATE</a>(app_start)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code hl_struct" href="#structkissm__state">kissm_state</a> *p_ns = NULL;</div>
<div class="line">    <span class="keywordflow">switch</span> (p_event-&gt;type)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#ggab374702413577f1460bbbe65b38a2bfba3266aee90c06bb02fa3d4521f13a5302">KISSM_EVT_ENTRY</a>:</div>
<div class="line">            <span class="comment">// do entry actions</span></div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#ggab374702413577f1460bbbe65b38a2bfba7f6309089bc79bb6ce3c5d5e7b3ae4d0">KISSM_EVT_EXIT</a>:</div>
<div class="line">            <span class="comment">// do exit actions</span></div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> APP_EVT:    <span class="comment">// application defined event</span></div>
<div class="line">            <span class="comment">// conditionals based on event type and data</span></div>
<div class="line">            p_ns = <a class="code hl_define" href="#ga14afc9ddc9cd84bf654a666bd7fa582c">KISSM_STATEREF</a>(appstate1);    <span class="comment">// transition to state1</span></div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">default</span>:     <span class="comment">// processing when there is no event</span></div>
<div class="line">            <span class="comment">// run background process, if any</span></div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> p_ns;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_define" href="#ga678f531476a9b2e9ba672b7e2510f8fe">KISSM_DEFSTATE</a>(appstate1)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// state handler body (see above for template)</span></div>
<div class="line">    <span class="keywordflow">return</span> p_ns;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_define" href="#ga678f531476a9b2e9ba672b7e2510f8fe">KISSM_DEFSTATE</a>(appstate2)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// state handler body (see above for template)</span></div>
<div class="line">    <span class="keywordflow">return</span> p_ns;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">...</div>
<div class="line"> </div>
<div class="line"><span class="comment">// application main loop</span></div>
<div class="line">int main(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// app init stuff</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// init the state machine with app first state</span></div>
<div class="line">    <a class="code hl_function" href="#ga5fde8e8926f97dbd2645d237c4fe2a9d">kissm_init</a>(<a class="code hl_define" href="#ga14afc9ddc9cd84bf654a666bd7fa582c">KISSM_STATEREF</a>(app_start);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// run loop</span></div>
<div class="line">    <span class="keywordflow">for</span> (;;)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// some app-specific method of collecting or generating events</span></div>
<div class="line">        <a class="code hl_struct" href="#structkissm__event">kissm_event</a> * pevt = app_event_generator();</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// KISSM_EVT_NONE may be a valid return from the event generator</span></div>
<div class="line"> </div>
<div class="line">        <span class="comment">// run the state machine</span></div>
<div class="line">        <a class="code hl_function" href="#ga711e7f57bd7575d29b7bdfcd51716979">kissm_run</a>(pevt);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="agroup__kissm_html_ga14afc9ddc9cd84bf654a666bd7fa582c"><div class="ttname"><a href="#ga14afc9ddc9cd84bf654a666bd7fa582c">KISSM_STATEREF</a></div><div class="ttdeci">#define KISSM_STATEREF(s)</div><div class="ttdoc">Create a reference to a named state struct.</div><div class="ttdef"><b>Definition</b> kissm.h:110</div></div>
<div class="ttc" id="agroup__kissm_html_ga2f02f4ce366579c77578a3a3b4a65581"><div class="ttname"><a href="#ga2f02f4ce366579c77578a3a3b4a65581">KISSM_DECLSTATE</a></div><div class="ttdeci">#define KISSM_DECLSTATE(s)</div><div class="ttdoc">Declare a state handler and state struct to hold the state details.</div><div class="ttdef"><b>Definition</b> kissm.h:116</div></div>
<div class="ttc" id="agroup__kissm_html_ga5fde8e8926f97dbd2645d237c4fe2a9d"><div class="ttname"><a href="#ga5fde8e8926f97dbd2645d237c4fe2a9d">kissm_init</a></div><div class="ttdeci">void kissm_init(struct kissm_state *init_state)</div><div class="ttdoc">Initialize the state machine with the application first state.</div></div>
<div class="ttc" id="agroup__kissm_html_ga678f531476a9b2e9ba672b7e2510f8fe"><div class="ttname"><a href="#ga678f531476a9b2e9ba672b7e2510f8fe">KISSM_DEFSTATE</a></div><div class="ttdeci">#define KISSM_DEFSTATE(s)</div><div class="ttdoc">A convenience macro to define a state handler function.</div><div class="ttdef"><b>Definition</b> kissm.h:123</div></div>
<div class="ttc" id="agroup__kissm_html_ga711e7f57bd7575d29b7bdfcd51716979"><div class="ttname"><a href="#ga711e7f57bd7575d29b7bdfcd51716979">kissm_run</a></div><div class="ttdeci">void kissm_run(const struct kissm_event *p_event)</div><div class="ttdoc">Run the state machine.</div></div>
<div class="ttc" id="agroup__kissm_html_ggab374702413577f1460bbbe65b38a2bfba3266aee90c06bb02fa3d4521f13a5302"><div class="ttname"><a href="#ggab374702413577f1460bbbe65b38a2bfba3266aee90c06bb02fa3d4521f13a5302">KISSM_EVT_ENTRY</a></div><div class="ttdeci">@ KISSM_EVT_ENTRY</div><div class="ttdoc">State is entering.</div><div class="ttdef"><b>Definition</b> kissm.h:143</div></div>
<div class="ttc" id="agroup__kissm_html_ggab374702413577f1460bbbe65b38a2bfba7f6309089bc79bb6ce3c5d5e7b3ae4d0"><div class="ttname"><a href="#ggab374702413577f1460bbbe65b38a2bfba7f6309089bc79bb6ce3c5d5e7b3ae4d0">KISSM_EVT_EXIT</a></div><div class="ttdeci">@ KISSM_EVT_EXIT</div><div class="ttdoc">State is exiting.</div><div class="ttdef"><b>Definition</b> kissm.h:142</div></div>
<div class="ttc" id="agroup__kissm_html_structkissm__event"><div class="ttname"><a href="#structkissm__event">kissm_event</a></div><div class="ttdoc">State machine event.</div><div class="ttdef"><b>Definition</b> kissm.h:160</div></div>
<div class="ttc" id="agroup__kissm_html_structkissm__state"><div class="ttname"><a href="#structkissm__state">kissm_state</a></div><div class="ttdoc">Defines a state &quot;object&quot; which contains all the information about a state.</div><div class="ttdef"><b>Definition</b> kissm.h:172</div></div>
</div><!-- fragment --> <hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="unionkissm__ptrbytes" id="unionkissm__ptrbytes"></a>
<h2 class="memtitle"><span class="permalink"><a href="#unionkissm__ptrbytes">&#9670;&#160;</a></span>kissm_ptrbytes</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">union kissm_ptrbytes</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Union to allow event data to be pointer or byte data. </p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a117104b82864d3b23ec174af6d392709" name="a117104b82864d3b23ec174af6d392709"></a>void *</td>
<td class="fieldname">
p</td>
<td class="fielddoc">
data as a pointer </td></tr>
<tr><td class="fieldtype">
<a id="a0d721733e3e472f29f463f59dc8aeb96" name="a0d721733e3e472f29f463f59dc8aeb96"></a>uint8_t</td>
<td class="fieldname">
b[sizeof(void *)]</td>
<td class="fielddoc">
data as bytes </td></tr>
</table>

</div>
</div>
<a name="structkissm__event" id="structkissm__event"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structkissm__event">&#9670;&#160;</a></span>kissm_event</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct kissm_event</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>State machine event. </p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="ac765329451135abec74c45e1897abf26" name="ac765329451135abec74c45e1897abf26"></a>int</td>
<td class="fieldname">
type</td>
<td class="fielddoc">
Type of event, <a class="el" href="#gab374702413577f1460bbbe65b38a2bfb">kissm_event_type</a> or app-specific. </td></tr>
<tr><td class="fieldtype">
<a id="a0f3d080119fc8b914f18ba785efde308" name="a0f3d080119fc8b914f18ba785efde308"></a>union <a class="el" href="#unionkissm__ptrbytes">kissm_ptrbytes</a></td>
<td class="fieldname">
data</td>
<td class="fielddoc">
Data associated with event, if any. </td></tr>
</table>

</div>
</div>
<a name="structkissm__state" id="structkissm__state"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structkissm__state">&#9670;&#160;</a></span>kissm_state</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct kissm_state</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Defines a state "object" which contains all the information about a state. </p>
<p>Use convenience macros instead of referring to this directly.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#ga2f02f4ce366579c77578a3a3b4a65581" title="Declare a state handler and state struct to hold the state details.">KISSM_DECLSTATE</a>, <a class="el" href="#ga14afc9ddc9cd84bf654a666bd7fa582c" title="Create a reference to a named state struct.">KISSM_STATEREF</a> </dd></dl>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a668ff86bbf2af3e28428f64c87904cf9" name="a668ff86bbf2af3e28428f64c87904cf9"></a>struct <a class="el" href="#structkissm__state">kissm_state</a> *(*)(const struct <a class="el" href="#structkissm__event">kissm_event</a> *)</td>
<td class="fieldname">
handler</td>
<td class="fielddoc">
handler function </td></tr>
<tr><td class="fieldtype">
<a id="ac1813db8c1b9a97ddddf6a2568a6b524" name="ac1813db8c1b9a97ddddf6a2568a6b524"></a>void *</td>
<td class="fieldname">
pdata</td>
<td class="fielddoc">
State instance data, if any (not used at this time) </td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ga14afc9ddc9cd84bf654a666bd7fa582c" name="ga14afc9ddc9cd84bf654a666bd7fa582c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga14afc9ddc9cd84bf654a666bd7fa582c">&#9670;&#160;</a></span>KISSM_STATEREF</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KISSM_STATEREF</td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>s</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a reference to a named state struct. </p>
<p>Useful for returning a new state from a state handler. </p>

</div>
</div>
<a id="ga2f02f4ce366579c77578a3a3b4a65581" name="ga2f02f4ce366579c77578a3a3b4a65581"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2f02f4ce366579c77578a3a3b4a65581">&#9670;&#160;</a></span>KISSM_DECLSTATE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KISSM_DECLSTATE</td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>s</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Declare a state handler and state struct to hold the state details. </p>
<p>Useful for creating forward declarations in the application. </p>

</div>
</div>
<a id="ga678f531476a9b2e9ba672b7e2510f8fe" name="ga678f531476a9b2e9ba672b7e2510f8fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga678f531476a9b2e9ba672b7e2510f8fe">&#9670;&#160;</a></span>KISSM_DEFSTATE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KISSM_DEFSTATE</td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>s</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A convenience macro to define a state handler function. </p>
<p>Use at the top of the state handler implementation. </p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="gab374702413577f1460bbbe65b38a2bfb" name="gab374702413577f1460bbbe65b38a2bfb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab374702413577f1460bbbe65b38a2bfb">&#9670;&#160;</a></span>kissm_event_type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#gab374702413577f1460bbbe65b38a2bfb">kissm_event_type</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Predefined event types. </p>
<p>Application should extend with app-specific enum starting with <a class="el" href="#ggab374702413577f1460bbbe65b38a2bfbadbd5ab9272e1f54e68046fc0037bdcdc">KISSM_EVT_APP</a>.</p>
<div class="fragment"><div class="line"><span class="keyword">enum</span> myapp_event_type</div>
<div class="line">{</div>
<div class="line">    EVT_APPSPECIFIC1 = <a class="code hl_enumvalue" href="#ggab374702413577f1460bbbe65b38a2bfbadbd5ab9272e1f54e68046fc0037bdcdc">KISSM_EVT_APP</a>,</div>
<div class="line">    EVT_AOOSOECIFIC2,</div>
<div class="line">    ...</div>
<div class="line">};</div>
<div class="ttc" id="agroup__kissm_html_ggab374702413577f1460bbbe65b38a2bfbadbd5ab9272e1f54e68046fc0037bdcdc"><div class="ttname"><a href="#ggab374702413577f1460bbbe65b38a2bfbadbd5ab9272e1f54e68046fc0037bdcdc">KISSM_EVT_APP</a></div><div class="ttdeci">@ KISSM_EVT_APP</div><div class="ttdoc">Starting event type for app-specific events.</div><div class="ttdef"><b>Definition</b> kissm.h:144</div></div>
</div><!-- fragment --> <table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ggab374702413577f1460bbbe65b38a2bfbaaed296044899b28ae15be980a2e44b9e" name="ggab374702413577f1460bbbe65b38a2bfbaaed296044899b28ae15be980a2e44b9e"></a>KISSM_EVT_NONE&#160;</td><td class="fielddoc"><p>No event occurred. </p>
</td></tr>
<tr><td class="fieldname"><a id="ggab374702413577f1460bbbe65b38a2bfba94384bb3aa5705a1993c1465c8c0b085" name="ggab374702413577f1460bbbe65b38a2bfba94384bb3aa5705a1993c1465c8c0b085"></a>KISSM_EVT_ANY&#160;</td><td class="fielddoc"><p>(not used at this time) </p>
</td></tr>
<tr><td class="fieldname"><a id="ggab374702413577f1460bbbe65b38a2bfba7f6309089bc79bb6ce3c5d5e7b3ae4d0" name="ggab374702413577f1460bbbe65b38a2bfba7f6309089bc79bb6ce3c5d5e7b3ae4d0"></a>KISSM_EVT_EXIT&#160;</td><td class="fielddoc"><p>State is exiting. </p>
</td></tr>
<tr><td class="fieldname"><a id="ggab374702413577f1460bbbe65b38a2bfba3266aee90c06bb02fa3d4521f13a5302" name="ggab374702413577f1460bbbe65b38a2bfba3266aee90c06bb02fa3d4521f13a5302"></a>KISSM_EVT_ENTRY&#160;</td><td class="fielddoc"><p>State is entering. </p>
</td></tr>
<tr><td class="fieldname"><a id="ggab374702413577f1460bbbe65b38a2bfbadbd5ab9272e1f54e68046fc0037bdcdc" name="ggab374702413577f1460bbbe65b38a2bfbadbd5ab9272e1f54e68046fc0037bdcdc"></a>KISSM_EVT_APP&#160;</td><td class="fielddoc"><p>Starting event type for app-specific events. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga5fde8e8926f97dbd2645d237c4fe2a9d" name="ga5fde8e8926f97dbd2645d237c4fe2a9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5fde8e8926f97dbd2645d237c4fe2a9d">&#9670;&#160;</a></span>kissm_init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void kissm_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="#structkissm__state">kissm_state</a> *</td>          <td class="paramname"><span class="paramname"><em>init_state</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize the state machine with the application first state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">init_state</td><td>reference to the first application state</td></tr>
  </table>
  </dd>
</dl>
<p>This function must be called before using <a class="el" href="#ga711e7f57bd7575d29b7bdfcd51716979" title="Run the state machine.">kissm_run()</a>. It can also be called at any time to reset the state machine.</p>
<p>Example:</p>
<div class="fragment"><div class="line">DECLSTATE(app_start);</div>
<div class="line">DECLSTATE(other_app_state);</div>
<div class="line"> </div>
<div class="line">...</div>
<div class="line"> </div>
<div class="line">DEFSTATE(app_start)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// state handler body</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">...</div>
<div class="line"> </div>
<div class="line"><span class="comment">// before main loop</span></div>
<div class="line"><span class="comment">// init the state machine</span></div>
<div class="line">kissm_init(<a class="code hl_define" href="#ga14afc9ddc9cd84bf654a666bd7fa582c">KISSM_STATEREF</a>(app_start));</div>
<div class="line"> </div>
<div class="line">...</div>
</div><!-- fragment --> 
</div>
</div>
<a id="ga711e7f57bd7575d29b7bdfcd51716979" name="ga711e7f57bd7575d29b7bdfcd51716979"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga711e7f57bd7575d29b7bdfcd51716979">&#9670;&#160;</a></span>kissm_run()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void kissm_run </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="#structkissm__event">kissm_event</a> *</td>          <td class="paramname"><span class="paramname"><em>p_event</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Run the state machine. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p_event</td><td>event to be passed to the state handler. May or may not cause a state transistion.</td></tr>
  </table>
  </dd>
</dl>
<p>This function should be called in order for the state machine handlers to perform processing. Each time this is called, the present state handler function will be called and passed the event. The state handler performs whatever processing is needed, including possible causing a state transition. State transitions are processed by this function when needed. Upon a state transition, the present state handler will be called again with the <a class="el" href="#ggab374702413577f1460bbbe65b38a2bfba7f6309089bc79bb6ce3c5d5e7b3ae4d0">KISSM_EVT_EXIT</a> event which should be used to perform any exit actions. And then the next state handler will be called with the event <a class="el" href="#ggab374702413577f1460bbbe65b38a2bfba3266aee90c06bb02fa3d4521f13a5302">KISSM_EVT_ENTRY</a> which can be used for performing entry actions.</p>
<p>The frequency of calling this function depends on the application state design. If states are designed to only perform any processing only when there is an event, then this only needs to be called when there is a new event. However, often a state will also require some ongoing processing to run some process while in a state. In this case this function can be called repeatedly with <a class="el" href="#ggab374702413577f1460bbbe65b38a2bfbaaed296044899b28ae15be980a2e44b9e">KISSM_EVT_NONE</a> which the state handler can use to perform normal state processing.</p>
<p>The application should implement a state machine ("main") loop that collects or generates events, and pass those events to this function. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
		<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
			<ul>
				<li class="footer">
					Generated on Wed Jan 22 2025 15:43:06 for BMSNode by <a href="http://www.doxygen.org/index.html">
					<img class="footer" src="doxygen.png" alt="doxygen"
                     onerror="this.onerror=null;this.src='doxygen.svg';"/></a> 1.11.0.
					Dark theme by <a href="http://majerle.eu" target="_new">Tilen Majerle</a>. All rights reserved.
				</li>
			</ul>
		</div>
		<script src="custom.js"></script>
	</body>
</html>
